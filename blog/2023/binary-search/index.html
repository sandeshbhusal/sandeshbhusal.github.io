<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Binary search is Bananas! | Bhusal's </title> <meta name="author" content="Sandesh Bhusal"> <meta name="description" content=""> <meta name="keywords" content="sandesh-bhusal,sandesh,bhusal,blog"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Spline+Sans+Mono:ital,wght@0,300..700;1,300..700|Material+Icons|PT+Serif:ital,wght@0,400;0,700;1,400;1,700|Inter:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-monokai.css?8ae2e3994bdbc9ef556d679b3cd92642" media="" id="highlight_theme_light"> <link defer href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://sandeshbhusal.github.io/blog/2023/binary-search/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Bhusal's </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/"> </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Blog </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link"><i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="row"> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">Binary search is Bananas!</h1> <p class="post-meta"> Created in August 19, 2023 </p> <p class="post-tags"> <a href="/blog/2023"> <i class="fa-solid fa-calendar fa-sm"></i> 2023 </a>   ·   <a href="/blog/tag/algorithms"> <i class="fa-solid fa-hashtag fa-sm"></i> algorithms</a>   <a href="/blog/tag/proofs"> <i class="fa-solid fa-hashtag fa-sm"></i> proofs</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <h2 id="refresher">Refresher</h2> <p>Binary search is one of the most trivial and elegant algorithms to understand, and yet, equally easy to get wrong while implementing it. There are a couple of checkpoints, comparisons and constants, which contribute to the running of the algorithm, which can be easily mistaken. In essence, binary search works by partitioning a given array into two halves successively, until a single element (or position) is reached where the target of interest may be. This means, during each run of the algorithm, we have the following choices to make:</p> <ul> <li>Has the algorithm terminated? If so, has it found the target (or position)?</li> <li>Which array is the array of interest currently, and which subsection will we explore next?</li> <li>Will the algorithm / loop terminate?</li> </ul> <p>Binary search keeps track of position information in two pointers (although a variant of <a href="https://www.geeksforgeeks.org/meta-binary-search-one-sided-binary-search/" rel="external nofollow noopener" target="_blank">one-sided binary search</a> is also possible). These pointers, can be called <code class="language-plaintext highlighter-rouge">low</code> and <code class="language-plaintext highlighter-rouge">high</code>, and represent the range of the array we are searching within (inclusive), i.e. <code class="language-plaintext highlighter-rouge">[low, high]</code>.</p> <h2 id="pseudocode">Pseudocode</h2> <p>Let’s proceed with a simple pseudocode implementation which leaves a lot of blanks out to be filled in later on (proofs, etc). It looks something like this:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">binarysearch</span><span class="p">(</span><span class="n">array</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">target</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="n">low</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="n">__</span><span class="p">,</span> <span class="n">__</span>
    <span class="k">while</span> <span class="n">low</span> <span class="n">__</span> <span class="n">high</span><span class="p">:</span>
        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">array</span><span class="p">[</span><span class="n">mid</span><span class="p">]</span> <span class="o">==</span> <span class="n">target</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">mid</span>
        <span class="k">if</span> <span class="n">array</span><span class="p">[</span><span class="n">mid</span><span class="p">]</span> <span class="n">__</span> <span class="n">target</span><span class="p">:</span>
            <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="n">__</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">-</span> <span class="n">__</span>

    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
</code></pre></div></div> <p>You must’ve noticed a few blanks in the pseudocode above. Don’t worry - we’ll fill them later on. For now, let’s define some properties we’d like the algorithm to have.</p> <h3 id="desired-properties">Desired properties.</h3> <p>Like the questions above, the desired properties for the algorithm can be described as follows:</p> <h4 id="correctness">Correctness:</h4> <ul> <li>The Algorithm must always produce a correct answer. That is, if an element exists in the array, it should return the index of the said element. Otherwise, it should return -1. If an element exists and the algorithm returns -1, it is incorrect, and the same can be said when a non-existing element search returns an index within the array.</li> </ul> <blockquote> <p>This kind of issue generally manifests itself in corner cases, like in a unit-sized array, or when the target element lies on the array boundaries (leftmost/rightmost element).</p> </blockquote> <h4 id="liveness">Liveness:</h4> <ul> <li>The Algorithm must always terminate. This means, for every array, the algorithm must produce an output and exit.</li> </ul> <blockquote> <p>This kind of issue generally manifests itself when the comparision operations within the algorithm fail. For an example, the bounds do not get updated, or there is a stray equality comparision which lets the algorithm run without stopping.</p> </blockquote> <h2 id="filling-in-the-blanks">Filling in the blanks</h2> <p>Let’s start filling in the blanks on the above code.</p> <h3 id="determining-search-starting-bounds-and-loop-invariant">Determining search starting bounds and loop invariant</h3> <p>The first blank decides where the array search starts. It is evident that we want to start searching from the beginning of the array, so it has the value of \(0\). The same can not be said for the high bound, though, because it determines what the loop condition will be. So let’s fill that out first.</p> <p>We know that a binary search converges when the length of the search array becomes unit, i.e. \(1\). This means, the left bound and right bound should coincide (since we are searching in an inclusive array, i.e. \( [low, high] \)). So the algorithm’s loop should run until the bounds coincide, at which point either the element is already found and returned, or the element was not found and the algorithm terminates. So, we have two ways to show non-coinciding bounds: \(loop\ while\ \ (low &lt; high)\) or \(loop\ while\ \ (low \neq high)\)</p> <p>If we opt to go with the second method, i.e. <code class="language-plaintext highlighter-rouge">loop while (left != right)</code>, then, the right bound cannot be set to <code class="language-plaintext highlighter-rouge">len(array) - 1</code>, since in a two-sized array, this will effectively prevent the looping from happening at all. So, the bounds and loop invariants can be determined as:</p> <ol> <li>If <code class="language-plaintext highlighter-rouge">low = 0</code>, <code class="language-plaintext highlighter-rouge">high = len(array)</code>, then the loop invariant to hold is <code class="language-plaintext highlighter-rouge">low &lt; high</code>.</li> <li>If <code class="language-plaintext highlighter-rouge">low = 0</code>, <code class="language-plaintext highlighter-rouge">high = len(array) - 1</code>, then the loop invariant to hold is <code class="language-plaintext highlighter-rouge">low &lt;= high</code>.</li> </ol> <h3 id="determining-the-conditional-check-at-mid">Determining the conditional check at <code class="language-plaintext highlighter-rouge">mid</code>.</h3> <p>Looking at the pseudocode again, we have this segment to fill out:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="bp">...</span>
        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">array</span><span class="p">[</span><span class="n">mid</span><span class="p">]</span> <span class="o">==</span> <span class="n">target</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">mid</span>
        <span class="k">if</span> <span class="n">array</span><span class="p">[</span><span class="n">mid</span><span class="p">]</span> <span class="n">__</span> <span class="n">target</span><span class="p">:</span>
            <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="n">__</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">-</span> <span class="n">__</span>
<span class="bp">...</span>
</code></pre></div></div> <p>Which is the inner part of the loop. The first check is to see if <code class="language-plaintext highlighter-rouge">array[mid]</code> meets the target, is smaller, etc. Since we have assumed an array sorted in the ascending order, we update the lower bound <em>only</em> when the middle element is such that the target cannot be in the LHS of the array. This means, target could be either less than, or equal to <code class="language-plaintext highlighter-rouge">array[mid]</code>. However, as we see above, when <code class="language-plaintext highlighter-rouge">array[mid] == target</code>, we have an early return. So the only conditional that can fit is <code class="language-plaintext highlighter-rouge">if array[mid] &lt; target</code>.</p> <h3 id="updating-bounds">Updating bounds</h3> <p>Lastly remaining - to update the bounds. When the middle element of the array is smaller than the target, there is no point starting the low bound again from midpoint, so we update it as <code class="language-plaintext highlighter-rouge">low = mid + 1</code>. However, if it is not smaller than the target, it means, it could be greater than the target, or equal to it. Since we already do an equality comparision with target above it, it would be strictly greater than the target. As such, we can exclude it from search next, so we update <code class="language-plaintext highlighter-rouge">high = mid - 1</code> in the next blank.</p> <h2 id="final-solution">Final solution</h2> <p>This generates the following code finally:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">binarysearch</span> <span class="p">(</span><span class="n">array</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">target</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="n">low</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="n">low</span> <span class="o">&lt;=</span> <span class="n">high</span><span class="p">:</span>
        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">array</span><span class="p">[</span><span class="n">mid</span><span class="p">]</span> <span class="o">==</span> <span class="n">target</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">mid</span>
        <span class="k">if</span> <span class="n">array</span><span class="p">[</span><span class="n">mid</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">target</span><span class="p">:</span>
            <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
</code></pre></div></div> <h2 id="proof-of-termination">Proof of termination</h2> <p>We are interested in checking that the algorithm terminates properly. Since we have chosen multiple constants and equality checks above based on one-another, they form a subset of choices that could’ve been made, so we will not check for correctness now.</p> <p>For proof of termination, we will check two scenarios, based on the bounds we chose to go with. They are:</p> <ol> <li> <code class="language-plaintext highlighter-rouge">high = len(array) - 1</code> and loop invariant as <code class="language-plaintext highlighter-rouge">low &lt;= high</code> </li> <li> <code class="language-plaintext highlighter-rouge">high = len(array)</code> and loop invariant as <code class="language-plaintext highlighter-rouge">low &lt; high</code> </li> </ol> <p>Now, we look to proving the loop will indeed converge, and for this, we will use proof by contradiction.</p> <h3 id="scenario-1">Scenario #1</h3> <ul> <li>For the loop to continue running forever when <code class="language-plaintext highlighter-rouge">loop until low &lt;= high</code> invariant is upheld, the <code class="language-plaintext highlighter-rouge">low</code> bound should be strictly less than or equal to the <code class="language-plaintext highlighter-rouge">high</code> bound. This means, no matter what happens, <code class="language-plaintext highlighter-rouge">low</code> can never exceed <code class="language-plaintext highlighter-rouge">high</code>.</li> <li>Which means <code class="language-plaintext highlighter-rouge">low = mid + 1</code>, i.e. <code class="language-plaintext highlighter-rouge">low = (low + high) // 2 + 1</code> never exceeds high.</li> <li>When <code class="language-plaintext highlighter-rouge">low == high</code>, however, <code class="language-plaintext highlighter-rouge">low = (low + high) // 2 + 1</code> becomes <code class="language-plaintext highlighter-rouge">low = (high + high) // 2 + 1</code>, i.e. <code class="language-plaintext highlighter-rouge">low = high + 1</code>.</li> <li>This means, in the next iteration, <code class="language-plaintext highlighter-rouge">low = high + 1</code> will violate the loop invariant, and the loop converges.</li> </ul> <h3 id="scenario-2">Scenario #2</h3> <ul> <li>For the loop to continue running forever when <code class="language-plaintext highlighter-rouge">loop until low &lt; high</code> invariant is upheld, the <code class="language-plaintext highlighter-rouge">low</code> bound should never be equal to or greater than the <code class="language-plaintext highlighter-rouge">high</code> bound. The greater condition is already proved above.</li> <li>This means <code class="language-plaintext highlighter-rouge">low</code> can never be equal to <code class="language-plaintext highlighter-rouge">high</code>.</li> <li>In a finally-converging loop with range size = 2, i.e. <code class="language-plaintext highlighter-rouge">low = high - 1</code>, by virtue of integer division flooring the <code class="language-plaintext highlighter-rouge">mid</code> value becomes: <code class="language-plaintext highlighter-rouge">mid = (low + high) // 2</code>, i.e. <code class="language-plaintext highlighter-rouge">mid = (high + high - 1) // 2</code>. Upon adding <code class="language-plaintext highlighter-rouge">1</code> to this in the loop update, <code class="language-plaintext highlighter-rouge">low = mid + 1</code>, it becomes <code class="language-plaintext highlighter-rouge">low = (high + high - 1) // 2 + 1</code>, which becomes equal to <code class="language-plaintext highlighter-rouge">high</code>.</li> <li>This means, in the next iteration, <code class="language-plaintext highlighter-rouge">low == high</code> will violate the loop invariant and the loop converges.</li> </ul> <h2 id="conclusion">Conclusion</h2> <p>This was a longer-than-expected blog post. Please let me know of any errors in the post by raising a issue in the <a href="https://github.com/sandeshbhusal/sandeshbhusal.github.io" rel="external nofollow noopener" target="_blank">github repository for this blog</a>.</p> </div> </article> </div> </div> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2025 Sandesh Bhusal. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?70d799092f862ad98c7876aa47712e20"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>